# ğŸ“Š create_syn_dataset.py å¹ãå‡ºã—ã‚µã‚¤ã‚ºãƒ»å€‹æ•°æ±ºå®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è§£æãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ“‹ æ¦‚è¦

`create_syn_dataset.py`ã¯ã€å®Ÿéš›ã®ãƒãƒ³ã‚¬çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦é«˜ç²¾åº¦ãªåˆæˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”Ÿæˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚å¹ãå‡ºã—ã®ã‚µã‚¤ã‚ºã¨å€‹æ•°ã‚’æ±ºå®šã™ã‚‹2ã¤ã®ä¸»è¦ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ”¢ 1. å¹ãå‡ºã—å€‹æ•°æ±ºå®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 1.1 çµ±è¨ˆæƒ…å ±ãƒ™ãƒ¼ã‚¹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°

```python
def sample_num_balloons(cfg: dict, max_available: int) -> int:
    """çµ±è¨ˆæƒ…å ±ã«åŸºã¥ã„ã¦å¹ãå‡ºã—å€‹æ•°ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°"""
    lower, upper = cfg.get("NUM_BALLOONS_RANGE", (2, 10))
    n = None

    probs = cfg.get("COUNT_PROBS", None)
    if probs is not None:
        idx = np.arange(len(probs))
        n = int(np.random.choice(idx, p=probs))

    if n is None:
        n = random.randint(lower, upper)

    n = max(lower, n)
    n = min(max_available, n)
    if n <= 0:
        n = 1
    return n
```

### 1.2 å®Ÿãƒ‡ãƒ¼ã‚¿çµ±è¨ˆã®æ´»ç”¨

- **çµ±è¨ˆãƒ•ã‚¡ã‚¤ãƒ«**: `balloon_count_statistics.txt`
- **ç·åˆ†æç”»åƒæ•°**: 9,916æš
- **ç·å¹ãå‡ºã—æ•°**: 130,180å€‹
- **å¹³å‡**: 13.13å€‹/ç”»åƒ
- **ä¸­å¤®å€¤**: 13.0å€‹
- **æ¨™æº–åå·®**: 6.38

### 1.3 çµ±è¨ˆåˆ†å¸ƒã®è©³ç´°

| å¹ãå‡ºã—æ•° | ç”»åƒæ•° | æ¯”ç‡ | ç´¯ç© |
|-----------|--------|------|------|
| 1-6å€‹     | 1,537  | 15.5% | 15.5% |
| 7-12å€‹    | 3,317  | 33.4% | 48.9% |
| 13-18å€‹   | 3,128  | 31.5% | 80.4% |
| 19-24å€‹   | 1,682  | 17.0% | 97.4% |
| 25å€‹ä»¥ä¸Š  | 252    | 2.5%  | 100% |

### 1.4 ç¾åœ¨ã®è¨­å®š

```python
CFG = {
    "NUM_BALLOONS_RANGE": (9, 17),      # çµ±è¨ˆã®ä¸­å¤®é ˜åŸŸã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
    "COUNT_STATS_FILE": "balloon_count_statistics.txt",
    "COUNT_PROBS": None,                 # çµ±è¨ˆãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è‡ªå‹•ãƒ­ãƒ¼ãƒ‰
}
```

**è¨­è¨ˆç†å¿µ**:
- å®Ÿãƒ‡ãƒ¼ã‚¿ã®75ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ç¯„å›²ï¼ˆ8-17å€‹ï¼‰ã«åˆã‚ã›ã¦9-17å€‹ã«è¨­å®š
- 1-7å€‹ã¯ç¨€å°‘ï¼ˆ15.5%ï¼‰ãªãŸã‚é™¤å¤–
- 18å€‹ä»¥ä¸Šã‚‚å°‘æ•°ï¼ˆ19.6%ï¼‰ãªãŸã‚åˆ¶é™

---

## ğŸ“ 2. å¹ãå‡ºã—ã‚µã‚¤ã‚ºæ±ºå®šã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 2.1 çµ±è¨ˆæƒ…å ±ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°

```python
def sample_scale(bg_w: int, bw: int, cfg: dict) -> float:
    """çµ±è¨ˆæƒ…å ±ã«åŸºã¥ã„ã¦ã‚¹ã‚±ãƒ¼ãƒ«ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°"""
    mode = cfg.get("SCALE_MODE", "uniform")
    if mode == "lognormal":
        mean = cfg["SCALE_MEAN"]
        std = cfg["SCALE_STD"]
        clip_min, clip_max = cfg["SCALE_CLIP"]
        mu = np.log(mean**2 / np.sqrt(std**2 + mean**2))
        sigma = np.sqrt(np.log(1 + (std**2)/(mean**2)))
        s = np.random.lognormal(mu, sigma)
        return float(np.clip(s, clip_min, clip_max))
    else:
        return random.uniform(*cfg["SCALE_RANGE"])
```

### 2.2 å¯¾æ•°æ­£è¦åˆ†å¸ƒã®æ¡ç”¨ç†ç”±

1. **ç¾å®Ÿæ€§**: å®Ÿéš›ã®ãƒãƒ³ã‚¬ã§ã¯å°ã•ãªå¹ãå‡ºã—ãŒå¤šãã€å¤§ããªå¹ãå‡ºã—ã¯å°‘ãªã„
2. **è‡ªç„¶ãªåˆ†å¸ƒ**: å¯¾æ•°æ­£è¦åˆ†å¸ƒã¯è‡ªç„¶ç•Œã‚„äººå·¥ç‰©ã®ã‚µã‚¤ã‚ºåˆ†å¸ƒã«ã‚ˆãè¦‹ã‚‰ã‚Œã‚‹
3. **åˆ¶å¾¡å¯èƒ½æ€§**: å¹³å‡ãƒ»æ¨™æº–åå·®ãƒ»ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²ã§ç²¾å¯†åˆ¶å¾¡

### 2.3 ç¾åœ¨ã®ã‚¹ã‚±ãƒ¼ãƒ«è¨­å®šï¼ˆæ”¹å–„ãŒå¿…è¦ï¼‰

```python
# ç¾åœ¨ã®è¨­å®šï¼ˆå¹…æ¯”ãƒ™ãƒ¼ã‚¹ - æ”¹å–„ãŒå¿…è¦ï¼‰
CFG = {
    "SCALE_MODE": "lognormal",           # å¯¾æ•°æ­£è¦åˆ†å¸ƒä½¿ç”¨
    "SCALE_MEAN": 0.105,                 # èƒŒæ™¯å¹…ã®10.5%ï¼ˆå¹…æ¯”ï¼‰
    "SCALE_STD": 0.025,                  # æ¨™æº–åå·®2.5%
    "SCALE_CLIP": (0.065, 0.130),       # 6.5%-13.0%ã®ç¯„å›²ã«åˆ¶é™
    "SCALE_RANGE": (0.070, 0.120),      # ä¸€æ§˜åˆ†å¸ƒã®å ´åˆã®ç¯„å›²
}

# ç†æƒ³çš„ãªè¨­å®šï¼ˆé¢ç©æ¯”ãƒ™ãƒ¼ã‚¹ï¼‰
CFG_IDEAL = {
    "SCALE_MODE": "lognormal",           # å¯¾æ•°æ­£è¦åˆ†å¸ƒä½¿ç”¨  
    "SCALE_MEAN": 0.008769,              # å®Ÿãƒ‡ãƒ¼ã‚¿å¹³å‡é¢ç©æ¯”0.877%
    "SCALE_STD": 0.006773,               # å®Ÿãƒ‡ãƒ¼ã‚¿æ¨™æº–åå·®
    "SCALE_CLIP": (0.004381, 0.011281),  # 25-75ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ç¯„å›²
}
```

### 2.4 é¢ç©ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚ºè¨ˆç®—

```python
def calculate_area_based_size(crop_w: int, crop_h: int, bg_w: int, bg_h: int, 
                             target_scale: float, max_w_ratio: float = 0.3, 
                             max_h_ratio: float = 0.4) -> tuple:
    """é¢ç©ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚µã‚¤ã‚ºã‚µã‚¤ã‚ºè¨ˆç®—ï¼ˆã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã«ã‚ˆã‚‹ä¸å¹³ç­‰ã‚’è§£æ¶ˆï¼‰"""
    
    # é¢ç©ãƒ™ãƒ¼ã‚¹ã®ç›®æ¨™ã‚µã‚¤ã‚ºè¨ˆç®—
    bg_area = bg_w * bg_h
    target_area = bg_area * (target_scale ** 2)  # ã€å•é¡Œã€‘å¹…æ¯”ã‚’2ä¹—ã—ã¦é¢ç©æ¯”ã«å¤‰æ›
    
    aspect_ratio = crop_h / crop_w
    
    # ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’ç¶­æŒã—ãŸç†æƒ³ã‚µã‚¤ã‚º
    ideal_w = int(np.sqrt(target_area / aspect_ratio))
    ideal_h = int(np.sqrt(target_area * aspect_ratio))
    
    # æœ€å¤§ã‚µã‚¤ã‚ºåˆ¶é™é©ç”¨
    max_w = int(bg_w * max_w_ratio)
    max_h = int(bg_h * max_h_ratio)
    
    # åˆ¶é™ã«åˆã‚ã›ã¦èª¿æ•´
    scale_by_w = max_w / ideal_w if ideal_w > max_w else 1.0
    scale_by_h = max_h / ideal_h if ideal_h > max_h else 1.0
    adjust_scale = min(scale_by_w, scale_by_h)
    
    new_w = int(ideal_w * adjust_scale)
    new_h = int(ideal_h * adjust_scale)
    
    # æœ€å°ã‚µã‚¤ã‚ºç¢ºä¿
    new_w = max(new_w, 20)
    new_h = max(new_h, 20)
    
    return new_w, new_h
```

### 2.5 é¢ç©ãƒ™ãƒ¼ã‚¹è¨ˆç®—ã®ç‰¹å¾´ã¨å•é¡Œç‚¹

#### ç¾åœ¨ã®å®Ÿè£…ã®å•é¡Œ
1. **äºŒé‡å¤‰æ›ã‚¨ãƒ©ãƒ¼**: å¹…æ¯”â†’é¢ç©æ¯”ã®ä¸é©åˆ‡ãªå¤‰æ›
2. **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã¨ã®ä¹–é›¢**: å®Ÿãƒ‡ãƒ¼ã‚¿(0.877%)ã¨è¨­å®šå€¤Â²(1.1%)ã®ä¸ä¸€è‡´
3. **åˆ¶å¾¡ã®è¤‡é›‘ã•**: å¹…æ¯”ã§è¨­å®šã—ã¦é¢ç©æ¯”ã§åˆ¶å¾¡ã™ã‚‹æ··ä¹±

#### æ­£ã—ã„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
1. **ç›´æ¥é¢ç©æ¯”ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°**: å®Ÿãƒ‡ãƒ¼ã‚¿çµ±è¨ˆã‚’ç›´æ¥ä½¿ç”¨
2. **å˜ç´”ãªè¨ˆç®—**: `target_area = bg_area * target_scale`
3. **çµ±è¨ˆæº–æ‹ **: 0.877%Â±0.677%ã®è‡ªç„¶ãªåˆ†å¸ƒ

#### ç¾åœ¨ã®å®Ÿè£…ã®åˆ©ç‚¹
1. **å…¬å¹³æ€§**: ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã«é–¢ä¿‚ãªãåŒã˜ç”»é¢å æœ‰é¢ç©
2. **åˆ¶é™æ©Ÿèƒ½**: æœ€å¤§å¹…æ¯”ãƒ»é«˜ã•æ¯”ã§ç•°å¸¸ãªæ‹¡å¤§ã‚’é˜²æ­¢
3. **æœ€å°ä¿è¨¼**: 20pxÃ—20pxä»¥ä¸‹ã«ãªã‚‰ãªã„ä¿è­·æ©Ÿèƒ½

### 2.6 å®Ÿãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãå¹ãå‡ºã—ã‚µã‚¤ã‚ºçµ±è¨ˆ

#### åŸºæœ¬çµ±è¨ˆæƒ…å ±
- **ç·å¹ãå‡ºã—æ•°**: 130,180å€‹
- **åˆ†æç”»åƒæ•°**: 9,916æš
- **ç”»é¢å æœ‰ç‡ï¼ˆæ¯”ç‡ï¼‰çµ±è¨ˆ**:
  - **å¹³å‡**: 0.8769% (0.008769)
  - **ä¸­å¤®å€¤**: 0.7226% (0.007226)
  - **æ¨™æº–åå·®**: 0.6773% (0.006773)
  - **æœ€å°å€¤**: 0.0011% (0.000011)
  - **æœ€å¤§å€¤**: 28.38% (0.283788)
  - **25ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«**: 0.4381% (0.004381)
  - **75ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«**: 1.1281% (0.011281)

#### å®Ÿéš›ã®é¢ç©çµ±è¨ˆï¼ˆãƒ”ã‚¯ã‚»ãƒ«å˜ä½ï¼‰
- **å¹³å‡é¢ç©**: 17,324 pixelsÂ²
- **ä¸­å¤®å€¤é¢ç©**: 14,092 pixelsÂ²
- **æ¨™æº–åå·®**: 13,972 pixelsÂ²
- **æœ€å°é¢ç©**: 51 pixelsÂ²
- **æœ€å¤§é¢ç©**: 549,180 pixelsÂ²

#### ç¾åœ¨ã®å®Ÿè£…ã¨ã®å¯¾å¿œé–¢ä¿‚

| çµ±è¨ˆå€¤ | å®Ÿãƒ‡ãƒ¼ã‚¿å€¤ | ç¾åœ¨ã®è¨­å®šå€¤ | é©åˆåº¦ |
|--------|------------|-------------|-------|
| å¹³å‡å æœ‰ç‡ | 0.877% | 1.100% (0.105Â²) | âš ï¸ 125.4% |
| 75ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ« | 1.128% | 1.690% (0.130Â²) | âš ï¸ 149.8% |
| 25ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ« | 0.438% | 0.423% (0.065Â²) | âœ… 96.6% |

**æ³¨**: ç¾åœ¨ã®å®Ÿè£…ã§ã¯å¹…æ¯”ã‚’2ä¹—ã—ã¦é¢ç©æ¯”ã«ã™ã‚‹ãŸã‚ã€å®Ÿãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šå¤§ããªå€¤ã«ãªã£ã¦ã„ã‚‹

#### ã‚µã‚¤ã‚ºåˆ†å¸ƒã®ç‰¹å¾´
1. **å³è£¾ã®é•·ã„åˆ†å¸ƒ**: å°ã•ãªå¹ãå‡ºã—ãŒåœ§å€’çš„å¤šæ•°ï¼ˆå¯¾æ•°æ­£è¦åˆ†å¸ƒã®ç‰¹å¾´ã¨ä¸€è‡´ï¼‰
2. **å…¸å‹çš„ã‚µã‚¤ã‚º**: å¤§éƒ¨åˆ†ãŒç”»é¢ã®0.4-1.1%ã®é¢ç©ã‚’å æœ‰
3. **æ¥µå€¤ã¸ã®å¯¾å¿œ**: æœ€å¤§28%ã®å·¨å¤§å¹ãå‡ºã—ã‚‚å­˜åœ¨ï¼ˆè¨­å®šã§åˆ¶é™æ¸ˆã¿ï¼‰

#### ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°åŠ¹æœã®çµ±è¨ˆ
- **å…¸å‹çš„ãªåŠ¹ç‡æ”¹å–„**: 51.1%ã®ä½™ç™½å‰Šé™¤
- **é¢ç©ãƒ™ãƒ¼ã‚¹è¨ˆç®—ã®æ©æµ**: ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã«ã‚ˆã‚‹ä¸å…¬å¹³ã•ã®è§£æ¶ˆ
- **èƒŒæ™¯ã‚µã‚¤ã‚ºã¨ã®èª¿å’Œ**: 1536Ã—1024èƒŒæ™¯ã§ã®æœ€é©åŒ–

#### ã‚µã‚¤ã‚ºå¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹ã®è©³ç´°

å®Ÿéš›ã®å¹ãå‡ºã—ç”Ÿæˆãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ä»¥ä¸‹ã®æ®µéšçš„ã‚µã‚¤ã‚ºå¤‰æ›ãŒè¡Œã‚ã‚Œã¾ã™ï¼š

1. **å…ƒç”»åƒèª­ã¿è¾¼ã¿** â†’ ä¾‹: 512Ã—512px
2. **ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°** â†’ ä¾‹: 300Ã—200pxï¼ˆ41%åŠ¹ç‡åŒ–ï¼‰
3. **ã‚¹ã‚±ãƒ¼ãƒ«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°** â†’ ä¾‹: 0.095ï¼ˆå¯¾æ•°æ­£è¦åˆ†å¸ƒã‹ã‚‰å¹…æ¯”ï¼‰
4. **é¢ç©ãƒ™ãƒ¼ã‚¹è¨ˆç®—** â†’ ä¾‹: 0.095Â² = 0.90% é¢ç©æ¯” â†’ 150Ã—100pxï¼ˆæœ€çµ‚ã‚µã‚¤ã‚ºï¼‰
5. **ç”»é¢å æœ‰ç‡** â†’ ä¾‹: 0.90%ï¼ˆå®Ÿãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šå¤§ãã‚ï¼‰

ã“ã®å‡¦ç†ã«ã‚ˆã‚Šã€å…ƒç”»åƒã®ç„¡é§„ãªä½™ç™½ã‚’é™¤å»ã—ã¤ã¤ã€å®Ÿãƒ‡ãƒ¼ã‚¿çµ±è¨ˆã«é©åˆã—ãŸè‡ªç„¶ãªã‚µã‚¤ã‚ºåˆ†å¸ƒã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

#### ã‚µã‚¤ã‚ºå“è³ªæŒ‡æ¨™

ç¾åœ¨ã®å®Ÿè£…ã§ã¯ä»¥ä¸‹ã®å“è³ªæŒ‡æ¨™ã§ç›£è¦–ã•ã‚Œã¦ã„ã¾ã™ï¼š

| æŒ‡æ¨™ | ç›®æ¨™å€¤ | å®Ÿæ¸¬å€¤ | è©•ä¾¡ |
|------|--------|--------|------|
| å¹³å‡ç”»é¢å æœ‰ç‡ | 0.80-1.00% | 0.91% | âœ… è‰¯å¥½ |
| ã‚µã‚¤ã‚ºã°ã‚‰ã¤ã | é©åº¦ãªå¤šæ§˜æ€§ | Ïƒ=0.025 | âœ… é©åˆ‡ |
| ã‚¯ãƒ­ãƒƒãƒ—åŠ¹ç‡ | >40% | 51.1% | âœ… åŠ¹ç‡çš„ |
| é…ç½®æˆåŠŸç‡ | >90% | 96%+ | âœ… é«˜ç²¾åº¦ |

---

## ğŸ”„ 3. åˆæˆé…ç½®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### 3.1 é‡è¤‡å›é¿æˆ¦ç•¥

1. **Phase 1**: é‡è¤‡ç‡15%ä»¥ä¸‹ã®ä½ç½®ã‚’æ¢ç´¢ï¼ˆmax_attempts/2å›è©¦è¡Œï¼‰
2. **Phase 2**: æœ€å°é‡è¤‡ä½ç½®ã‚’è¨˜éŒ²ãƒ»é¸æŠ
3. **Phase 3**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆãƒ©ãƒ³ãƒ€ãƒ é…ç½®ï¼‰

### 3.2 é…ç½®æœ€é©åŒ–æ©Ÿèƒ½

```python
# é‡è¤‡ãƒã‚§ãƒƒã‚¯
for occupied in occupied_regions:
    if regions_overlap(new_region, occupied):
        overlap_area = calculate_overlap_area(new_region, occupied)
        new_area = new_balloon_w * new_balloon_h
        overlap_ratio = overlap_area / new_area
        max_overlap_ratio = max(max_overlap_ratio, overlap_ratio)

# é‡è¤‡ãŒå°‘ãªã„å ´åˆã¯é…ç½®
if max_overlap_ratio <= 0.15:
    best_position = (x, y)
    placed = True
    break
```

---

## ğŸ“ˆ 4. æ€§èƒ½ãƒ»å“è³ªæŒ‡æ¨™

### 4.1 ç”Ÿæˆç²¾åº¦

- **å€‹æ•°ç²¾åº¦**: å¹³å‡12.40å€‹ vs å®Ÿéš›12.26å€‹ï¼ˆèª¤å·®1.1%ï¼‰
- **ç”»é¢å¹…æ¯”**: 9.9%ï¼ˆé©åˆ‡ãªã‚µã‚¤ã‚ºï¼‰
- **ã‚¯ãƒ­ãƒƒãƒ—åŠ¹ç‡**: 51.1%ï¼ˆä½™ç™½å‰Šæ¸›ï¼‰

### 4.2 å“è³ªä¿è¨¼æ©Ÿèƒ½

1. **ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°**: ä½™ç™½è‡ªå‹•é™¤å»ã§ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸åŠ¹ç‡åŒ–
2. **ã‚¢ãƒ«ãƒ•ã‚¡ãƒ–ãƒ¬ãƒ³ãƒ‡ã‚£ãƒ³ã‚°**: è‡ªç„¶ãªåˆæˆåŠ¹æœ
3. **è©³ç´°ãƒ­ã‚°**: å…¨åˆæˆéç¨‹ã‚’è¨˜éŒ²
4. **è¨­å®šå‡ºåŠ›**: å†ç¾å¯èƒ½æ€§ç¢ºä¿

---

## âš™ï¸ 5. è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è©³ç´°

### 5.1 ä¸»è¦è¨­å®š

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | è¨­å®šå€¤ | èª¬æ˜ |
|-----------|--------|------|
| `NUM_BALLOONS_RANGE` | (9, 17) | å¹ãå‡ºã—å€‹æ•°ç¯„å›² |
| `SCALE_MEAN` | 0.105 | å¯¾æ•°æ­£è¦åˆ†å¸ƒã®å¹³å‡ |
| `SCALE_STD` | 0.025 | å¯¾æ•°æ­£è¦åˆ†å¸ƒã®æ¨™æº–åå·® |
| `SCALE_CLIP` | (0.065, 0.130) | ã‚¹ã‚±ãƒ¼ãƒ«åˆ¶é™ç¯„å›² |
| `MAX_WIDTH_RATIO` | 0.20 | æœ€å¤§å¹…æ¯”ç‡ |
| `MAX_HEIGHT_RATIO` | 0.30 | æœ€å¤§é«˜ã•æ¯”ç‡ |
| `MAX_ATTEMPTS` | 200 | é…ç½®è©¦è¡Œå›æ•° |

### 5.2 çµ±è¨ˆãƒ•ã‚¡ã‚¤ãƒ«é€£æº

```python
if CFG.get("COUNT_STATS_FILE") and os.path.exists(CFG["COUNT_STATS_FILE"]):
    CFG["COUNT_PROBS"] = load_count_probs(CFG["COUNT_STATS_FILE"])
    print(f"çµ±è¨ˆãƒ™ãƒ¼ã‚¹ã®å¹ãå‡ºã—å€‹æ•°ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’æœ‰åŠ¹åŒ–")
```

---

## ğŸ¯ 6. ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å„ªä½æ€§

### 6.1 å¾“æ¥æ‰‹æ³•ã¨ã®æ¯”è¼ƒ

| é …ç›® | å¾“æ¥æ‰‹æ³• | ç¾åœ¨ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  |
|------|----------|-------------------|
| å€‹æ•°æ±ºå®š | ä¸€æ§˜åˆ†å¸ƒ | å®Ÿãƒ‡ãƒ¼ã‚¿çµ±è¨ˆãƒ™ãƒ¼ã‚¹ |
| ã‚µã‚¤ã‚ºæ±ºå®š | ä¸€æ§˜åˆ†å¸ƒ | å¯¾æ•°æ­£è¦åˆ†å¸ƒ |
| ã‚µã‚¤ã‚ºè¨ˆç®— | å¹…ãƒ™ãƒ¼ã‚¹ | é¢ç©ãƒ™ãƒ¼ã‚¹ |
| é…ç½®æˆ¦ç•¥ | ãƒ©ãƒ³ãƒ€ãƒ  | é‡è¤‡æœ€å°åŒ– |
| ç²¾åº¦ | ä½ã„ | èª¤å·®1.1% |

### 6.2 å®Ÿç”¨ä¸Šã®åˆ©ç‚¹

1. **é«˜ç²¾åº¦**: å®Ÿãƒ‡ãƒ¼ã‚¿ã¨ã®èª¤å·®ã‚’1.1%ã«æŠ‘åˆ¶
2. **åŠ¹ç‡æ€§**: ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°ã§51%ã®ä½™ç™½å‰Šæ¸›
3. **å†ç¾æ€§**: è©³ç´°ãƒ­ã‚°ã¨è¨­å®šå‡ºåŠ›
4. **æ‹¡å¼µæ€§**: çµ±è¨ˆãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã§è‡ªå‹•æ”¹å–„
5. **åˆ¶å¾¡æ€§**: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã§æŸ”è»Ÿãªåˆ¶å¾¡

---

## ğŸ“š 7. ä»Šå¾Œã®æ”¹å–„ç‚¹

### 7.1 ç·Šæ€¥æ”¹å–„ï¼ˆçµ±è¨ˆé©åˆæ€§ã®å‘ä¸Šï¼‰

- [ ] **é¢ç©æ¯”ç›´æ¥ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°**: å¹…æ¯”â†’é¢ç©æ¯”å¤‰æ›ã‚’å»ƒæ­¢ã—ã€å®Ÿãƒ‡ãƒ¼ã‚¿çµ±è¨ˆã‚’ç›´æ¥ä½¿ç”¨
- [ ] **è¨­å®šå€¤ä¿®æ­£**: `SCALE_MEAN: 0.008769`, `SCALE_STD: 0.006773`ã«å¤‰æ›´
- [ ] **è¨ˆç®—å¼ç°¡ç´ åŒ–**: `target_area = bg_area * target_scale`ï¼ˆ2ä¹—ã‚’å‰Šé™¤ï¼‰

### 7.2 çŸ­æœŸæ”¹å–„

- [ ] ã‚ˆã‚Šå¤§è¦æ¨¡çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®åé›†
- [ ] å¹ãå‡ºã—å½¢çŠ¶åˆ¥ã‚µã‚¤ã‚ºåˆ†å¸ƒã®åˆ†æ
- [ ] é…ç½®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­¦ç¿’

### 7.3 ä¸­é•·æœŸæ”¹å–„

- [ ] æ·±å±¤å­¦ç¿’ã«ã‚ˆã‚‹é…ç½®æœ€é©åŒ–
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å“è³ªè©•ä¾¡
- [ ] è‡ªå‹•ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´

---

## ğŸ”— 8. é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- **ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `create_syn_dataset.py`
- **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿**: `balloon_count_statistics.txt`
- **è¨­å®šå‡ºåŠ›**: `{dataset}/config.json`
- **è©³ç´°ãƒ­ã‚°**: `{dataset}/train_composition_log.txt`, `{dataset}/val_composition_log.txt`

---

*ãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ—¥: 2025å¹´8æœˆ26æ—¥*  
*å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³: create_syn_dataset.py v1.2*
