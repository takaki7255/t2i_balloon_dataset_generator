"""
CFGè¨­å®šä¿®æ­£ã®è©³ç´°èª¬æ˜Žã¨æ ¹æ‹ 
"""

def explain_cfg_corrections():
    print("=== CFGè¨­å®šä¿®æ­£ã®è©³ç´°èª¬æ˜Ž ===")
    print()
    
    print("ðŸ“Š **çµ±è¨ˆãƒ‡ãƒ¼ã‚¿åˆ†æžçµæžœ**")
    print("â€¢ å®Ÿéš›ã®ãƒžãƒ³ã‚¬ã®å¹ãå‡ºã—å€‹æ•°: å¹³å‡13.1å€‹ã€25-75%ç¯„å›² 8-17å€‹")
    print("â€¢ å®Ÿéš›ã®ãƒžãƒ³ã‚¬ã®å¹ãå‡ºã—ã‚µã‚¤ã‚º: å¹³å‡é¢ç©æ¯”0.877%ã€å¹…æ¯”ç´„9.4%")
    print("â€¢ å®Ÿéš›ã®ã‚µã‚¤ã‚ºåˆ†å¸ƒ: 25-75%ç¯„å›²ã§å¹…æ¯”6.6%-10.6%")
    print()
    
    print("ðŸ”§ **ä¿®æ­£å†…å®¹ã¨æ ¹æ‹ **")
    print()
    
    print("1ï¸âƒ£ **å¹ãå‡ºã—å€‹æ•°ç¯„å›²**")
    print("   ä¿®æ­£å‰: (7, 17)")
    print("   ä¿®æ­£å¾Œ: (8, 17)")
    print("   æ ¹æ‹ : å®Ÿéš›ã®çµ±è¨ˆ25%å€¤ã¯8å€‹ã€‚7å€‹ã¯çµ±è¨ˆçš„ã«å°‘ãªã™ãŽã‚‹")
    print()
    
    print("2ï¸âƒ£ **ã‚¹ã‚±ãƒ¼ãƒ«ç¯„å›²**")
    print("   ä¿®æ­£å‰: (0.065, 0.110)")
    print("   ä¿®æ­£å¾Œ: (0.065, 0.110)")
    print("   æ ¹æ‹ : å®Ÿéš›ã®çµ±è¨ˆ25-75%ç¯„å›²(6.6%-10.6%)ã«åˆã‚ã›ã¦è¨­å®š")
    print("   åŠ¹æžœ: ã‚ˆã‚Šç¾å®Ÿçš„ãªã‚µã‚¤ã‚ºåˆ†å¸ƒã‚’å®Ÿç¾")
    print()
    
    print("3ï¸âƒ£ **ã‚¹ã‚±ãƒ¼ãƒ«å¹³å‡å€¤**")
    print("   ä¿®æ­£å‰: 0.10")
    print("   ä¿®æ­£å¾Œ: 0.094")
    print("   æ ¹æ‹ : å®Ÿéš›ã®çµ±è¨ˆå¹³å‡å€¤9.4%ã«æ­£ç¢ºã«åˆã‚ã›ã‚‹")
    print("   åŠ¹æžœ: ç”Ÿæˆãƒ‡ãƒ¼ã‚¿ãŒå®Ÿéš›ã®ãƒžãƒ³ã‚¬ã¨ã‚ˆã‚Šä¸€è‡´")
    print()
    
    print("4ï¸âƒ£ **ã‚¹ã‚±ãƒ¼ãƒ«æ¨™æº–åå·®**")
    print("   ä¿®æ­£å‰: 0.030")
    print("   ä¿®æ­£å¾Œ: 0.020")
    print("   æ ¹æ‹ : å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿åˆ†æ•£ã«åˆã‚ã›ã¦ã‚ˆã‚ŠæŽ§ãˆã‚ã«è¨­å®š")
    print("   åŠ¹æžœ: æ¥µç«¯ãªã‚µã‚¤ã‚ºå¤‰å‹•ã‚’æŠ‘åˆ¶")
    print()
    
    print("5ï¸âƒ£ **ã‚¹ã‚±ãƒ¼ãƒ«ã‚¯ãƒªãƒƒãƒ—ç¯„å›²**")
    print("   ä¿®æ­£å‰: (0.05, 0.18)")
    print("   ä¿®æ­£å¾Œ: (0.050, 0.125)")
    print("   æ ¹æ‹ : çµ±è¨ˆç¯„å›²ã«ä½™è£•ã‚’æŒãŸã›ã¤ã¤ã€æ¥µç«¯å€¤ã‚’é™¤åŽ»")
    print("   åŠ¹æžœ: ç¾å®Ÿçš„ã§ã‚ã‚ŠãªãŒã‚‰æŸ”è»Ÿæ€§ã®ã‚ã‚‹ç¯„å›²")
    print()
    
    print("6ï¸âƒ£ **æœ€å¤§ã‚µã‚¤ã‚ºåˆ¶é™**")
    print("   ä¿®æ­£å‰: å¹…30%, é«˜ã•40%")
    print("   ä¿®æ­£å¾Œ: å¹…15%, é«˜ã•25%")
    print("   æ ¹æ‹ : å®Ÿéš›ã®ãƒžãƒ³ã‚¬ã§ã¯å·¨å¤§ãªå¹ãå‡ºã—ã¯ç¨€")
    print("   åŠ¹æžœ: ã‚ˆã‚Šç¾å®Ÿçš„ãªæœ€å¤§ã‚µã‚¤ã‚ºåˆ¶é™")
    print()
    
    print("ðŸ“ˆ **ä¿®æ­£åŠ¹æžœã®äºˆæƒ³**")
    print("âœ… ç”Ÿæˆã•ã‚Œã‚‹å¹ãå‡ºã—ã‚µã‚¤ã‚ºãŒå®Ÿéš›ã®ãƒžãƒ³ã‚¬ã«è¿‘ã¥ã")
    print("âœ… å€‹æ•°åˆ†å¸ƒãŒçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚Šå¿ å®Ÿã«ãªã‚‹")
    print("âœ… æ¥µç«¯ã«å¤§ããªå¹ãå‡ºã—ã®ç”Ÿæˆã‚’æŠ‘åˆ¶")
    print("âœ… é¢ç©ãƒ™ãƒ¼ã‚¹ãƒªã‚µã‚¤ã‚ºã¨ã®çµ„ã¿åˆã‚ã›ã§æ›´ã«ç²¾åº¦å‘ä¸Š")
    print("âœ… å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®å“è³ªå‘ä¸Šã«ã‚ˆã‚Šã€ãƒ¢ãƒ‡ãƒ«æ€§èƒ½å‘ä¸ŠãŒæœŸå¾…")
    print()
    
    print("âš ï¸ **æ³¨æ„ç‚¹**")
    print("â€¢ ã‚¹ã‚±ãƒ¼ãƒ«ç¯„å›²ã‚’ç‹­ã‚ãŸãŸã‚ã€ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚„ã‚„æ¸›å°‘")
    print("â€¢ ãŸã ã—ã€å®Ÿéš›ã®ãƒžãƒ³ã‚¬ã«è¿‘ã„åˆ†å¸ƒã«ãªã‚‹ãŸã‚ã‚ˆã‚Šæœ‰ç”¨")
    print("â€¢ å¿…è¦ã«å¿œã˜ã¦ã€ç‰¹å®šç”¨é€”å‘ã‘ã«ç¯„å›²ã‚’èª¿æ•´å¯èƒ½")

def validate_new_settings():
    """æ–°è¨­å®šã®å¦¥å½“æ€§ã‚’æ¤œè¨¼"""
    print("\n" + "=" * 60)
    print("ðŸ” **æ–°è¨­å®šã®å¦¥å½“æ€§æ¤œè¨¼**")
    print()
    
    # æ–°ã—ã„è¨­å®šå€¤
    new_cfg = {
        "NUM_BALLOONS_RANGE": (8, 17),
        "SCALE_RANGE": (0.065, 0.110),
        "SCALE_MEAN": 0.094,
        "SCALE_STD": 0.020,
        "SCALE_CLIP": (0.050, 0.125),
        "MAX_WIDTH_RATIO": 0.15,
        "MAX_HEIGHT_RATIO": 0.25,
    }
    
    # å®Ÿéš›ã®çµ±è¨ˆ
    actual_stats = {
        "count_25th": 8.0,
        "count_75th": 17.0,
        "size_ratio_mean": 0.008769,
        "width_ratio_mean": 0.094,  # sqrt(0.008769)
        "width_ratio_25th": 0.066,
        "width_ratio_75th": 0.106,
    }
    
    print("å€‹æ•°è¨­å®šã®æ¤œè¨¼:")
    min_count, max_count = new_cfg["NUM_BALLOONS_RANGE"]
    if min_count >= actual_stats["count_25th"] and max_count <= actual_stats["count_75th"]:
        print(f"âœ… å€‹æ•°ç¯„å›² {new_cfg['NUM_BALLOONS_RANGE']} ã¯çµ±è¨ˆ25-75%ç¯„å›²å†…")
    else:
        print(f"âŒ å€‹æ•°ç¯„å›²ã«å•é¡Œã‚ã‚Š")
    
    print("\nã‚µã‚¤ã‚ºè¨­å®šã®æ¤œè¨¼:")
    scale_mean = new_cfg["SCALE_MEAN"]
    scale_min, scale_max = new_cfg["SCALE_RANGE"]
    
    if abs(scale_mean - actual_stats["width_ratio_mean"]) < 0.005:
        print(f"âœ… å¹³å‡ã‚¹ã‚±ãƒ¼ãƒ« {scale_mean:.3f} ã¯çµ±è¨ˆå¹³å‡ {actual_stats['width_ratio_mean']:.3f} ã¨ä¸€è‡´")
    else:
        print(f"âš ï¸ å¹³å‡ã‚¹ã‚±ãƒ¼ãƒ«ã«å·®ç•°ã‚ã‚Š")
    
    if (scale_min >= actual_stats["width_ratio_25th"] * 0.95 and 
        scale_max <= actual_stats["width_ratio_75th"] * 1.05):
        print(f"âœ… ã‚¹ã‚±ãƒ¼ãƒ«ç¯„å›² {new_cfg['SCALE_RANGE']} ã¯çµ±è¨ˆç¯„å›²ã¨é©åˆ")
    else:
        print(f"âš ï¸ ã‚¹ã‚±ãƒ¼ãƒ«ç¯„å›²è¦ç¢ºèª")
    
    print("\né¢ç©æ¯”ã§ã®ç¢ºèª:")
    area_min = scale_min ** 2
    area_max = scale_max ** 2
    area_mean = scale_mean ** 2
    
    print(f"æ–°è¨­å®šã§ã®é¢ç©æ¯”: {area_min*100:.2f}%-{area_max*100:.2f}% (å¹³å‡{area_mean*100:.2f}%)")
    print(f"å®Ÿéš›ã®çµ±è¨ˆé¢ç©æ¯”: {actual_stats['size_ratio_mean']*100:.3f}%")
    
    if abs(area_mean - actual_stats["size_ratio_mean"]) < actual_stats["size_ratio_mean"] * 0.2:
        print("âœ… é¢ç©æ¯”ã‚‚çµ±è¨ˆã¨é©åˆ")
    else:
        print("âš ï¸ é¢ç©æ¯”è¦ç¢ºèª")

if __name__ == "__main__":
    explain_cfg_corrections()
    validate_new_settings()
